<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>CodEditor | ULTRA MASTER V24</title>
    <script src="https://cdn.jsdelivr.net/pyodide/v0.23.4/full/pyodide.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.23.0/ace.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.23.0/ext-language_tools.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-database-compat.js"></script>
    <style>
        :root { --accent: #00ff41; --bg: #000; --owner: #ff00c8; --member: #00d4ff; --warn: #ffcc00; --error: #ff4444; --panel-bg: #0a0a0a; --py-blue: #3776ab; }
        body { margin: 0; background: var(--bg); color: white; font-family: 'Courier New', monospace; overflow: hidden; height: 100vh; display: flex; flex-direction: column; }
        body::before { content: ""; position: fixed; inset: 0; z-index: 9999; pointer-events: none; border: 2px solid; border-image: linear-gradient(90deg, #f00, #48ff00, #002bff, #ff00c8) 1; animation: borderRotate 8s linear infinite; }
        @keyframes borderRotate { 0% { filter: hue-rotate(0deg); } 100% { filter: hue-rotate(360deg); } }

        /* REHBER PANELƒ∞ */
        #guide-panel { position: fixed; left: -350px; top: 0; width: 320px; height: 100%; background: #050505; border-right: 3px solid var(--accent); z-index: 10005; transition: 0.5s cubic-bezier(0.4, 0, 0.2, 1); padding: 25px; overflow-y: auto; box-shadow: 20px 0 50px rgba(0,0,0,0.9); }
        #guide-panel.open { left: 0; }
        .guide-header { border-bottom: 1px solid var(--accent); padding-bottom: 10px; margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center; }
        .guide-item { background: #111; border: 1px solid #222; padding: 12px; margin-bottom: 15px; border-radius: 8px; }
        .guide-item h4 { color: var(--accent); margin: 0 0 8px 0; font-size: 14px; }
        .guide-item code { color: var(--warn); display: block; background: #000; padding: 5px; border-radius: 4px; font-size: 12px; margin-top: 5px; }

        /* PYTHON TERMINAL */
        #python-console { position: absolute; bottom: 60px; left: 350px; width: 500px; height: 250px; background: rgba(5,5,5,0.98); border: 2px solid var(--py-blue); border-radius: 10px; z-index: 3000; display: none; flex-direction: column; }
        #py-header { background: var(--py-blue); color: white; padding: 10px 15px; font-size: 12px; font-weight: bold; display: flex; justify-content: space-between; border-radius: 8px 8px 0 0; }
        #py-output { flex: 1; overflow-y: auto; padding: 15px; font-size: 13px; color: #00ff41; white-space: pre-wrap; }

        header { padding: 12px 25px; background: #080808; border-bottom: 1px solid #1a1a1a; display: flex; justify-content: space-between; align-items: center; z-index: 1001; }
        .nav-btn { background: #111; color: var(--accent); border: 1px solid var(--accent); padding: 8px 15px; border-radius: 5px; cursor: pointer; font-weight: bold; transition: 0.3s; }
        .nav-btn:hover { background: var(--accent); color: #000; }
        
        #auth-screen { position: fixed; inset: 0; background: #000; z-index: 10000; display: flex; justify-content: center; align-items: center; }
        .auth-box { border: 1px solid var(--accent); padding: 40px; width: 450px; text-align: center; background: #050505; border-radius: 15px; }

        #main-container { display: flex; flex: 1; overflow: hidden; }
        #editor { flex: 1; font-size: 16px; background: #000 !important; }
        #sidebar { width: 320px; background: #050505; border-left: 1px solid #1a1a1a; display: flex; flex-direction: column; padding: 15px; }
        #chat-box { flex: 1; overflow-y: auto; font-size: 11px; margin-bottom: 10px; padding: 10px; background: #020202; border: 1px solid #111; border-radius: 8px; }
        
        .run-btn { background: var(--py-blue); color: white; border: none; padding: 8px 20px; border-radius: 5px; cursor: pointer; font-weight: bold; display: none; }
    </style>
</head>
<body>

<div id="guide-panel">
    <div class="guide-header">
        <h2 style="color:var(--accent); margin:0;">Sƒ∞STEM REHBERƒ∞</h2>
        <button onclick="toggleGuide()" style="background:none; border:none; color:var(--error); cursor:pointer; font-weight:bold; font-size:20px;">X</button>
    </div>
    <div class="guide-item">
        <h4>üêç PYTHON √áALI≈ûTIRMA</h4>
        <p style="font-size:11px; color:#aaa;">Kodunu yaz, saƒü √ºstteki <b>RUN</b> butonuna bas.</p>
        <code>print("Selam Berk!")</code>
    </div>
    <div class="guide-item">
        <h4>üì• AKILLI ƒ∞NDƒ∞RME</h4>
        <p style="font-size:11px; color:#aaa;">Se√ßtiƒüin dile g√∂re otomatik uzantƒ± (.py, .html, .js) eklenir.</p>
    </div>
</div>

<div id="auth-screen">
    <div class="auth-box">
        <h1 style="color:var(--accent)">[ PREM_V24 ]</h1>
        <input type="text" id="user-name" placeholder="KULLANICI ADI" style="width:100%; padding:10px; margin-bottom:10px; background:#111; border:1px solid #333; color:white;">
        <input type="password" id="user-pass" placeholder="≈ûƒ∞FRE" style="width:100%; padding:10px; margin-bottom:10px; background:#111; border:1px solid #333; color:white;">
        <button onclick="handleAuth('login')" style="width:100%; padding:15px; background:var(--accent); color:black; font-weight:bold; border:none; cursor:pointer;">Sƒ∞STEME Gƒ∞Rƒ∞≈û YAP</button>
    </div>
</div>

<header>
    <div style="color:var(--accent); font-weight:bold; font-size:18px;">> KERNEL_V24_AUTO</div>
    <div style="display: flex; gap: 10px; align-items: center;">
        <button class="nav-btn" onclick="toggleGuide()">‚ùì REHBER</button>
        <button id="run-py-btn" class="run-btn" onclick="runPython()">‚ñ∂ RUN</button>
        <button id="dl-btn" class="nav-btn" style="border-color:var(--warn); color:var(--warn);" onclick="exportFile()">üì• ƒ∞NDƒ∞R (.py)</button>
        <select id="lang-select" onchange="changeLanguage()" style="background:#000; color:var(--accent); border:1px solid var(--accent); padding: 5px;">
            <option value="python">Python</option>
            <option value="javascript">JavaScript</option>
            <option value="html">HTML</option>
            <option value="css">CSS</option>
        </select>
        <button id="owner-btn" style="display:none; background:var(--owner); color:white; border:none; padding:8px 18px; cursor:pointer; border-radius:20px; font-weight:bold;" onclick="togglePanel()">KOMUTA MERKEZƒ∞</button>
    </div>
</header>

<div id="main-container">
    <div id="editor"># V24 Otomatik Uzantƒ± Aktif!
print("Sag ustteki indir butonu dile gore degisir.")</div>

    <div id="python-console">
        <div id="py-header"><span>PYTHON TERMINAL</span><span onclick="closePy()" style="cursor:pointer;">[KAPAT]</span></div>
        <div id="py-output">Python Yukleniyor...</div>
    </div>

    <div id="sidebar">
        <div id="chat-box"></div>
        <input type="text" id="chat-input" style="background:#111; border:1px solid #333; color:#fff; width:100%; padding:10px;" placeholder="Mesaj g√∂nder...">
    </div>
</div>

<script>
    const firebaseConfig = { apiKey: "AIzaSyDpaFcKI6XhYuWCiyZHUFey0T6uqKy8IPA", authDomain: "prem-d18e3.firebaseapp.com", databaseURL: "https://prem-d18e3-default-rtdb.firebaseio.com", projectId: "prem-d18e3", storageBucket: "prem-d18e3.firebasestorage.app", messagingSenderId: "828611092580", appId: "1:828611092580:web:5f8e2c7c501c63a2d73f71" };
    firebase.initializeApp(firebaseConfig); const db = firebase.database();
    
    let pyodideInstance = null;
    async function initPython() {
        pyodideInstance = await loadPyodide();
        document.getElementById("py-output").innerText = "Python Hazƒ±r.\n";
        document.getElementById("run-py-btn").style.display = "block";
    }
    initPython();

    const editor = ace.edit("editor");
    editor.setTheme("ace/theme/terminal");
    editor.session.setMode("ace/mode/python");

    // AKILLI UZANTI Sƒ∞STEMƒ∞
    const extensions = { python: ".py", javascript: ".js", html: ".html", css: ".css" };

    function changeLanguage() {
        const l = document.getElementById("lang-select").value;
        editor.session.setMode("ace/mode/" + l);
        document.getElementById("run-py-btn").style.display = (l === 'python') ? 'block' : 'none';
        
        // Buton metnini g√ºncelle
        const ext = extensions[l] || ".txt";
        document.getElementById("dl-btn").innerHTML = `üì• ƒ∞NDƒ∞R (${ext})`;
    }

    function exportFile() {
        const l = document.getElementById("lang-select").value;
        const ext = extensions[l] || ".txt";
        const blob = new Blob([editor.getValue()], {type: "text/plain"});
        const a = document.createElement("a");
        a.href = URL.createObjectURL(blob);
        a.download = "kod_kaydi" + ext; // Uzantƒ± burada ekleniyor
        a.click();
    }

    async function runPython() {
        document.getElementById("python-console").style.display = "flex";
        const out = document.getElementById("py-output");
        out.innerText = "Calisiyor...\n";
        try {
            const code = editor.getValue();
            await pyodideInstance.runPythonAsync(`import sys, io\nsys.stdout = io.StringIO()`);
            await pyodideInstance.runPythonAsync(code);
            out.innerText = pyodideInstance.runPython("sys.stdout.getvalue()") || "Kod calisti.";
        } catch (e) { out.innerText = "HATA: " + e; }
    }

    function toggleGuide() { document.getElementById('guide-panel').classList.toggle('open'); }
    function closePy() { document.getElementById("python-console").style.display = "none"; }
    async function handleAuth(mode) {
        const u = document.getElementById("user-name").value;
        const p = document.getElementById("user-pass").value;
        if(u && p) {
            document.getElementById("auth-screen").style.display = "none";
            if(p === "P9$mR@26!Xz#Q7_vK1*Lp-99") document.getElementById("owner-btn").style.display = "block";
        }
    }
</script>
</body>
</html>
