<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>CodEditor | ULTRA MASTER V21</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.23.0/ace.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.23.0/ext-language_tools.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-database-compat.js"></script>
    <style>
        :root { --accent: #00ff41; --bg: #000; --owner: #ff00c8; --member: #00d4ff; --warn: #ffcc00; --error: #ff4444; --panel-bg: #0a0a0a; --sys: #ffff00; --ai-bg: #0e1217; }
        body { margin: 0; background: var(--bg); color: white; font-family: 'Courier New', monospace; overflow: hidden; height: 100vh; display: flex; flex-direction: column; }
        body::before { content: ""; position: fixed; inset: 0; z-index: 9999; pointer-events: none; border: 2px solid; border-image: linear-gradient(90deg, #f00, #48ff00, #002bff, #ff00c8) 1; animation: borderRotate 8s linear infinite; }
        @keyframes borderRotate { 0% { filter: hue-rotate(0deg); } 100% { filter: hue-rotate(360deg); } }
        
        .shake { animation: shake 0.5s infinite; }
        @keyframes shake { 0% { transform: translate(1px, 1px) rotate(0deg); } 10% { transform: translate(-1px, -2px) rotate(-1deg); } 50% { transform: translate(-3px, 0px) rotate(1deg); } 100% { transform: translate(1px, -1px) rotate(0deg); } }
        .invert { filter: invert(1) hue-rotate(180deg); }

        /* REHBER PANELƒ∞ STƒ∞LLERƒ∞ */
        #guide-panel { position: fixed; left: -300px; top: 0; width: 280px; height: 100%; background: #080808; border-right: 2px solid var(--accent); z-index: 5000; transition: 0.4s; padding: 20px; overflow-y: auto; }
        #guide-panel.open { left: 0; }
        .guide-btn-toggle { position: absolute; right: -40px; top: 50%; transform: translateY(-50%); background: var(--accent); color: #000; border: none; padding: 10px 5px; cursor: pointer; border-radius: 0 5px 5px 0; font-weight: bold; writing-mode: vertical-rl; }
        .guide-item { background: #111; border: 1px solid #222; padding: 10px; margin-bottom: 15px; border-radius: 5px; font-size: 11px; }
        .guide-item h4 { color: var(--accent); margin: 0 0 5px 0; border-bottom: 1px solid #333; }
        .guide-item code { color: var(--warn); display: block; margin-top: 5px; background: #000; padding: 3px; }

        #auth-screen { position: fixed; inset: 0; background: #000; z-index: 10000; display: flex; justify-content: center; align-items: center; }
        .auth-box { border: 1px solid var(--accent); padding: 40px; width: 450px; text-align: center; background: #050505; border-radius: 15px; box-shadow: 0 0 20px rgba(0,255,65,0.2); }
        .system-warning { color: var(--warn); font-size: 11px; border: 1px dashed var(--warn); padding: 15px; margin-bottom: 20px; text-align: left; background: rgba(255, 204, 0, 0.05); line-height: 1.6; }
        
        .auth-box input { width: 100%; padding: 12px; margin-bottom: 12px; background: #111; border: 1px solid #333; color: var(--accent); outline: none; border-radius: 8px; box-sizing: border-box; }
        .btn-row { display: flex; gap: 10px; }
        .auth-btn { flex: 1; padding: 12px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; transition: 0.3s; }
        .reg-btn { background: #222; color: white; border: 1px solid var(--accent); }
        .log-btn { background: var(--accent); color: black; }
        .sub-lang { display: block; font-size: 9px; opacity: 0.7; font-weight: normal; }

        header { padding: 12px 25px; background: #080808; border-bottom: 1px solid #1a1a1a; display: flex; justify-content: space-between; align-items: center; z-index: 1000; }
        #main-container { display: flex; flex: 1; overflow: hidden; position: relative; }
        #editor { flex: 1; font-size: 16px; background: #000 !important; }
        #sidebar { width: 320px; background: #050505; border-left: 1px solid #1a1a1a; display: flex; flex-direction: column; padding: 15px; }
        #chat-box { flex: 1; overflow-y: auto; font-size: 11px; margin-bottom: 10px; padding: 10px; background: #020202; border-radius: 10px; border: 1px solid #111; }

        #ai-assistant { position: absolute; left: 50px; top: 100px; width: 300px; background: var(--ai-bg); border: 1px solid var(--member); border-radius: 12px; display: flex; flex-direction: column; z-index: 2000; box-shadow: 0 0 20px rgba(0, 212, 255, 0.2); }
        #ai-drag { background: var(--member); color: #000; padding: 10px; font-weight: bold; font-size: 11px; border-radius: 11px 11px 0 0; cursor: move; }
        #ai-body { height: 300px; display: flex; flex-direction: column; }
        #ai-content { flex: 1; overflow-y: auto; padding: 10px; font-size: 11px; color: #ccc; }
        #ai-query { width: 100%; background: transparent; border: none; border-top: 1px solid #222; color: #fff; padding: 12px; outline: none; }
        
        #owner-panel { position: fixed; right: -850px; top: 0; width: 800px; height: 100%; background: var(--panel-bg); z-index: 10001; transition: 0.5s; padding: 30px; overflow-y: auto; border-left: 3px solid var(--owner); }
        .panel-section { background: #111; padding: 20px; margin-bottom: 20px; border-radius: 12px; border: 1px solid #222; }
        .op-btn { background: #1a1a1a; border: 1px solid #333; color: #aaa; padding: 10px; font-size: 10px; cursor: pointer; border-radius: 6px; width: 100%; margin-top: 5px; font-weight: bold; }
        .user-card { background: #080808; border: 1px solid #333; padding: 10px; margin-bottom: 5px; cursor: pointer; border-radius: 5px; font-size: 12px; display: flex; justify-content: space-between; }
        .ghost-screen { height: 180px; background: #000; border: 1px solid var(--accent); color: var(--accent); padding: 10px; font-size: 11px; overflow-y: auto; white-space: pre-wrap; margin-top: 10px; }
        
        .rgb-marquee { background: #050505; border-top: 1px solid #1a1a1a; height: 35px; display: flex; align-items: center; overflow: hidden; }
        #marquee-wrap { display: flex; white-space: nowrap; animation: marquee-flow 25s linear infinite; }
        .rgb-item { font-size: 13px; font-weight: 900; padding: 0 60px; animation: rgb-rainbow 6s linear infinite; }
        @keyframes marquee-flow { from { transform: translateX(0); } to { transform: translateX(-50%); } }
        @keyframes rgb-rainbow { 0% { color: #f00; } 50% { color: #0df; } 100% { color: #f00; } }

        .export-btn { background: var(--accent); color: #000; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; font-weight: bold; font-size: 12px; margin-right: 10px; }
    </style>
</head>
<body>

<div id="guide-panel">
    <button class="guide-btn-toggle" onclick="toggleGuide()">REHBER / GUIDE</button>
    <h3 style="color:var(--accent); text-align:center;">Dƒ∞L REHBERƒ∞</h3>
    
    <div class="guide-item">
        <h4>PYTHON</h4>
        Basit ve g√º√ßl√º. Ekrana yazƒ±:<br>
        <code>print("Selam D√ºnya")</code>
        Deƒüi≈üken tanƒ±mlama:<br>
        <code>sayi = 10</code>
    </div>

    <div class="guide-item">
        <h4>C++</h4>
        Hƒ±z i√ßin idealdir:<br>
        <code>#include &lt;iostream&gt;</code>
        <code>int main() { ... }</code>
    </div>

    <div class="guide-item">
        <h4>CSS</h4>
        Tasarƒ±m dilidir:<br>
        <code>body { background: #000; }</code>
        <code>.yazi { color: red; }</code>
    </div>

    <div class="guide-item">
        <h4>JAVASCRIPT</h4>
        Web i≈ülevselliƒüi:<br>
        <code>alert("Sistem Aktif!");</code>
        <code>console.log("Log");</code>
    </div>

    <div class="guide-item">
        <h4>Sƒ∞STEM NOTU</h4>
        Kodunuzu saƒü √ºstten dile g√∂re ayarlamayƒ± unutmayƒ±n!
    </div>
</div>

<div id="auth-screen">
    <div class="auth-box">
        <div style="color:var(--accent); margin-bottom:15px; font-weight:bold; font-size: 24px;">[ PREM_EDITION ]</div>
        <div class="system-warning">
            <b style="color:var(--warn)">[ SARI KURALLAR / YELLOW RULES ]</b><br><br>
            ‚Ä¢ Instagram: <b>@rw_f00t</b><br>
            ‚Ä¢ <b>Aynƒ± kullanƒ±cƒ± adƒ±yla farklƒ± hesaplar a√ßƒ±labilir.</b><br>
            <span class="sub-lang">(Multiple accounts can be created with the same username.)</span><br>
            ‚Ä¢ <b>Chat 10 dakikada bir resetlenir.</b><br>
            <span class="sub-lang">(Chat resets every 10 minutes.)</span><br>
            ‚Ä¢ <b>Dosya Dƒ±≈üa Aktarma Sistemi Eklendi.</b><br>
            <span class="sub-lang">(File Export System Added.)</span>
        </div>
        <input type="text" id="user-name" placeholder="KULLANICI ADI (USERNAME)">
        <input type="password" id="user-pass" placeholder="≈ûƒ∞FRE (PASSWORD)">
        <div class="btn-row">
            <button class="auth-btn reg-btn" onclick="handleAuth('register')">HESAP KUR<br><span style="font-size:8px">CREATE ACCOUNT</span></button>
            <button class="auth-btn log-btn" onclick="handleAuth('login')">Gƒ∞Rƒ∞≈û YAP<br><span style="font-size:8px">LOGIN</span></button>
        </div>
    </div>
</div>

<header>
    <div style="color:var(--accent); font-weight:bold; font-size:18px;">> KERNEL_ULTRA_V21</div>
    <div style="display: flex; gap: 10px; align-items: center;">
        <button class="export-btn" onclick="exportFile()">DOSYAYI ƒ∞NDƒ∞R<br><span style="font-size:8px">DOWNLOAD FILE</span></button>
        <select id="lang-select" onchange="changeLanguage()" style="background:#000; color:var(--accent); border:1px solid var(--accent); border-radius:5px; padding: 5px;">
            <option value="python">Python</option>
            <option value="c_cpp">C++</option>
            <option value="csharp">C#</option>
            <option value="java">Java</option>
            <option value="javascript">JavaScript</option>
            <option value="html">HTML</option>
            <option value="css">CSS</option>
            <option value="php">PHP</option>
            <option value="sql">SQL</option>
            <option value="json">JSON</option>
        </select>
        <button id="owner-btn" style="display:none; background:var(--owner); color:white; border:none; padding:8px 18px; cursor:pointer; border-radius:20px; font-weight:bold;" onclick="togglePanel()">KOMUTA MERKEZƒ∞<br><span style="font-size:8px">COMMAND CENTER</span></button>
    </div>
</header>

<div id="main-container">
    <div id="editor"># V21 GitHub Ready. Kontrol sizde. / You are in control.</div>

    <div id="ai-assistant">
        <div id="ai-drag">SMART AI ASƒ∞STAN (ASSISTANT)</div>
        <div id="ai-body">
            <div id="ai-content"><div><b>AI:</b> Selam, sistemler hazƒ±r! / Hi, systems are ready!</div></div>
            <input type="text" id="ai-query" placeholder="Mesaj yaz... (Type a message...)" onkeypress="handleAI(event)">
        </div>
    </div>

    <div id="sidebar">
        <div id="chat-box"></div>
        <input type="text" id="chat-input" style="background:#111; border:1px solid #333; color:#fff; width:100%; padding:10px; border-radius:5px;" placeholder="Global Chat...">
    </div>
</div>

<div id="owner-panel">
    <h2 style="color:var(--owner); text-align:center;">KOMUTA MERKEZƒ∞<br><span style="font-size:12px">COMMAND CENTER</span></h2>
    <div class="panel-section" style="border-color: var(--sys);">
        <b style="color: var(--sys);">CHAT KONTROL (CHAT CONTROL)</b>
        <div style="margin: 10px 0; font-size: 12px;">OTO RESET (AUTO): <span id="reset-timer" style="color:var(--error); font-weight:bold;">600</span>s</div>
        <button class="op-btn" style="background:var(--error); color:white; border:none;" onclick="resetChatHistory()">CHATI SIFIRLA (RESET CHAT)</button>
    </div>
    <div class="panel-section">
        <b style="color:var(--accent)">MARQUEE / REKLAM (ADS)</b>
        <input type="text" id="marquee-input" style="width:100%; padding:10px; background:#000; border:1px solid var(--accent); color:var(--accent); margin-top:5px;">
        <div style="display:flex; gap:10px; margin-top:5px;">
            <button class="op-btn" onclick="updateMarquee()">G√úNCELLE (UPDATE)</button>
            <button class="op-btn" onclick="resetMarquee()">SIFIRLA (RESET)</button>
        </div>
    </div>
    <div class="panel-section">
        <div style="display:flex; justify-content: space-between;">
            <b>HEDEF (TARGET): <span id="target-name-view" style="color:var(--member)">NONE</span></b>
            <div>≈ûƒ∞FRE (PASS): <span id="target-pass-view" style="color:var(--warn)">****</span> <span onclick="togglePassView()" style="cursor:pointer;">üëÅÔ∏è</span></div>
        </div>
        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px; margin-top:10px;">
            <button class="op-btn" style="background:var(--error); color:white;" onclick="adminDeleteAccount()">Sƒ∞L (DELETE)</button>
            <button class="op-btn" style="background:var(--sys); color:black;" onclick="sendPersonalAlert()">MSJ (MSG)</button>
            <button class="op-btn" onclick="trollCommand('shake')">Sƒ∞STEM-X1</button>
            <button class="op-btn" onclick="trollCommand('invert')">Sƒ∞STEM-X2</button>
        </div>
    </div>
    <div class="panel-section"><b>GHOST VIEW (LIVE)</b><div id="ghost-view" class="ghost-screen"></div></div>
    <div class="panel-section"><b>√úYELER (MEMBERS)</b><div id="user-list"></div></div>
    <button onclick="togglePanel()" style="width:100%; padding:15px; background:#222; color:white; border:none; cursor:pointer;">PANELƒ∞ KAPAT (CLOSE PANEL)</button>
</div>

<div class="rgb-marquee"><div id="marquee-wrap"></div></div>

<script>
    const firebaseConfig = { apiKey: "AIzaSyDpaFcKI6XhYuWCiyZHUFey0T6uqKy8IPA", authDomain: "prem-d18e3.firebaseapp.com", databaseURL: "https://prem-d18e3-default-rtdb.firebaseio.com", projectId: "prem-d18e3", storageBucket: "prem-d18e3.firebasestorage.app", messagingSenderId: "828611092580", appId: "1:828611092580:web:5f8e2c7c501c63a2d73f71" };
    firebase.initializeApp(firebaseConfig); const db = firebase.database(); 
    const MASTER_KEY = "P9$mR@26!Xz#Q7_vK1*Lp-99";
    
    let user = ""; let isAdmin = false; let targetHash = ""; let rawPass = ""; let isPassVisible = false; let resetCount = 600; let myHash = "";

    function toggleGuide() { document.getElementById('guide-panel').classList.toggle('open'); }

    function exportFile() {
        const text = editor.getValue();
        const blob = new Blob([text], { type: "text/plain" });
        const anchor = document.createElement("a");
        anchor.download = "code_export.txt";
        anchor.href = window.URL.createObjectURL(blob);
        anchor.click();
    }

    function handleAI(e) {
        if(e.key === "Enter") {
            const q = e.target.value; const cont = document.getElementById("ai-content");
            cont.innerHTML += `<div><b>Soru:</b> ${q}</div>`; e.target.value = "";
            setTimeout(() => {
                let ans = "T√ºm sistemler aktif ve rehber paneli eklendi. / All systems active.";
                cont.innerHTML += `<div style="color:var(--member)"><b>AI:</b> ${ans}</div>`;
                cont.scrollTop = cont.scrollHeight;
            }, 500);
        }
    }

    async function handleAuth(mode) {
        const rumuz = document.getElementById("user-name").value.trim();
        const sifre = document.getElementById("user-pass").value.trim();
        if(!rumuz || !sifre) return;
        const hash = btoa(rumuz + sifre).replace(/[/+=]/g, ""); myHash = hash;
        if(sifre === MASTER_KEY) { isAdmin = true; loginSuccess(rumuz, hash, sifre); return; }
        const snap = await db.ref("accounts/" + hash).get();
        if(mode === 'register') {
            if(snap.exists()) alert("Hata! / Error!");
            else { await db.ref("accounts/" + hash).set({ name: rumuz, pass: sifre }); loginSuccess(rumuz, hash, sifre); }
        } else {
            if(snap.exists()) loginSuccess(rumuz, hash, sifre); else alert("Hatalƒ±! / Error!");
        }
    }

    function loginSuccess(rumuz, hash, sifre) {
        user = rumuz; document.getElementById("auth-screen").style.display = "none";
        if(isAdmin) document.getElementById("owner-btn").style.display = "block";
        db.ref("users/" + hash).set({ name: rumuz, status: "online", isOwner: isAdmin, pass: sifre });
        db.ref("users/" + hash).onDisconnect().remove();
        editor.session.on('change', () => { db.ref("watch/" + hash).update({ code: editor.getValue() }); });
        setInterval(() => {
            resetCount--; if(isAdmin) document.getElementById("reset-timer").innerText = resetCount;
            if(resetCount <= 0) { if(isAdmin) resetChatHistory(); resetCount = 600; }
        }, 1000);
    }

    function resetChatHistory() { db.ref("chat").remove(); resetCount = 600; }

    db.ref("chat").on("value", (s) => {
        const b = document.getElementById("chat-box"); b.innerHTML = "";
        s.forEach((c) => {
            const d = c.val(); let color = d.isOwner ? 'var(--member)' : 'white';
            b.innerHTML += `<div style="margin-bottom:4px;"><b style="color:${color}">${d.user}:</b> ${d.msg}</div>`;
        });
        b.scrollTop = 9999;
    });

    document.getElementById("chat-input").onkeypress = (e) => {
        if(e.key === "Enter") { db.ref("chat").push({ user: user, msg: e.target.value, isOwner: isAdmin }); e.target.value = ""; }
    };

    function updateMarquee() { const t = document.getElementById("marquee-input").value; if(t) db.ref("system/marquee").set(t); }
    function resetMarquee() { db.ref("system/marquee").set("PREM MASTER EDITION | G√úVENLƒ∞ KODLAMA | @rw_f00t"); }
    function togglePassView() { isPassVisible = !isPassVisible; document.getElementById("target-pass-view").innerText = isPassVisible ? rawPass : "****"; }
    function togglePanel() { const p = document.getElementById("owner-panel"); p.style.right = (p.style.right === "0px") ? "-850px" : "0px"; }
    function sendPersonalAlert() { const m = prompt("Mesaj:"); if(m && targetHash) db.ref("commands/" + targetHash).set({ type: 'alert', msg: m }); }
    function trollCommand(cmd) { if(targetHash) db.ref("commands/" + targetHash).set({ type: cmd, time: Date.now() }); }
    async function adminDeleteAccount() {
        if(!targetHash) return;
        if(confirm("Silinsin mi? / Delete?")) { await db.ref("accounts/" + targetHash).remove(); await db.ref("users/" + targetHash).remove(); }
    }

    db.ref("users").on("value", (s) => {
        const list = document.getElementById("user-list"); list.innerHTML = "";
        s.forEach((u) => {
            const div = document.createElement("div"); div.className = "user-card";
            div.innerHTML = `<span>${u.val().name}</span> <span>${u.val().isOwner ? 'OWNER' : 'ONLINE'}</span>`;
            div.onclick = () => {
                targetHash = u.key; rawPass = u.val().pass;
                document.getElementById("target-name-view").innerText = u.val().name;
                db.ref("watch/" + targetHash).on("value", (ws) => { document.getElementById("ghost-view").innerText = ws.val()?.code || ""; });
            };
            list.appendChild(div);
        });
    });

    db.ref("commands").on("child_added", (s) => {
        if(s.key === myHash) {
            const c = s.val();
            if(c.type === 'alert') alert("‚ö†Ô∏è MESAJ: " + c.msg);
            if(c.type === 'shake') { document.body.classList.add("shake"); setTimeout(()=>document.body.classList.remove("shake"), 5000); }
            if(c.type === 'invert') { document.body.classList.add("invert"); setTimeout(()=>document.body.classList.remove("invert"), 5000); }
            db.ref("commands/" + myHash).remove();
        }
    });

    const editor = ace.edit("editor");
    editor.setTheme("ace/theme/terminal");
    editor.session.setMode("ace/mode/python");
    ace.require("ace/ext/language_tools");
    editor.setOptions({ enableBasicAutocompletion: true, enableLiveAutocompletion: true, enableSnippets: true });

    db.ref("system/marquee").on("value", (s) => { document.getElementById("marquee-wrap").innerHTML = `<span class="rgb-item">${s.val() || "PREM MASTER"}</span>`.repeat(6); });
    function changeLanguage() { editor.session.setMode("ace/mode/" + document.getElementById("lang-select").value); }

    const aiBox = document.getElementById("ai-assistant");
    const aiDrag = document.getElementById("ai-drag");
    let isDragging = false, offset = [0,0];
    aiDrag.onmousedown = (e) => { isDragging = true; offset = [aiBox.offsetLeft - e.clientX, aiBox.offsetTop - e.clientY]; };
    document.onmousemove = (e) => { if (isDragging) { aiBox.style.left = (e.clientX + offset[0]) + "px"; aiBox.style.top = (e.clientY + offset[1]) + "px"; } };
    document.onmouseup = () => isDragging = false;
</script>
</body>
</html>
